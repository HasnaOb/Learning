import { Meta } from '@storybook/addon-docs/blocks';

<Meta title="Guide/07 - Lección/1- Providers" />

# Providers

## Introducción

En esta lección vamos a ver un concepto nuevo: los providers y los mocks.
Estos dos conceptos son muy importantes a la hora de crear aplicaciones escalables y mantenibles.
Además, nos ayudarán a escribir tests más efectivos y a simular diferentes escenarios en nuestras aplicaciones.

## Providers

Los providers son componentes o servicios que proporcionan datos o funcionalidades a otros componentes.
Por ejemplo, un provider puede ser un servicio que obtiene datos de una API y los proporciona al componente estos datos.

Los providers son útiles porque nos permiten separar la lógica de obtención de datos de la lógica de presentación.

Para empezár veremos que hemos modificado nuestro componente `hello-word` y le hemos añadido una llamada en el connectedCallback.

```javascript
async connectedCallback() {
    await this.getData();
}
```

Recordemos que como esta llamada es asíncrona, tenemos que verificar que el connectedCallback sea una función asíncrona.

Dentro del método `getData`, hemos añadido la llamada a un provider que nos devuelve los datos de un usuario.

```javascript
async getData() {
    try {
      this.userData = await this.providerApiUser.getDataUser('12345');
    } catch (error) {
      throw new Error('Error fetching user data:', error);
    }
}
```

Este provider es una instancia de una clase que hemos creado llamada `ProviderApiUser`. Que puedes ver en el constructor del componente.

```javascript
this.providerApiUser = new ProviderApiUser();
```

El provider `ProviderApiUser` es una clase que se encarga de obtener los datos del usuario desde una API externa.
Puedes ver la implementación completa del provider en el archivo `ApiUser.js`.

Este provider tiene un método llamado `getDataUser` que recibe un ID de usuario y devuelve los datos del usuario correspondiente.

```javascript
async getDataUser(userId) {
    // Simulamos una llamada a una API externa
    const response = await fetch(`https://api.example.com/users/${userId}`);
    if (!response.ok) {
      throw new Error('Network response was not ok');
    }
    const data = await response.json();
    return new UserModel(data);
}
```

Este método utiliza la función `fetch` para hacer una llamada a una API externa y obtener los datos del usuario.
Luego, convierte los datos obtenidos en una instancia de la clase `UserModel`, que es un modelo de datos que hemos creado para representar a un usuario.

El modelo `UserModel` es una clase que define la estructura de los datos del usuario. Se usa para asegurarnos de que los datos que obtenemos del provider tienen la estructura correcta.

```javascript
export class UserModel {
  constructor({ id, name, email, typeUser }) {
    this.id = id;
    this.name = name;
    this.email = email;
    this.typeUser = typeUser;
  }
}
```

En resumen, los providers nos permiten separar la lógica de obtención de datos de la lógica de presentación, lo que hace que nuestro código sea más limpio y mantenible.
